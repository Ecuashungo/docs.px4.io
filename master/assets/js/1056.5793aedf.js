(window.webpackJsonp=window.webpackJsonp||[]).push([[1056],{2219:function(a,t,Q){"use strict";Q.r(t);var r=Q(18),e=Object(r.a)({},(function(){var a=this,t=a.$createElement,Q=a._self._c||t;return Q("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[Q("h1",{attrs:{id:"making-serial-port-drivers-user-configurable"}},[Q("a",{staticClass:"header-anchor",attrs:{href:"#making-serial-port-drivers-user-configurable"}},[a._v("#")]),a._v(" Making Serial Port Drivers User-Configurable")]),a._v(" "),Q("p",[a._v("This topic explains how to set up a serial driver so that it can be end-user configured (via parameters) to run on any of a flight controller board's configurable serial ports.")]),a._v(" "),Q("h2",{attrs:{id:"preconditions"}},[Q("a",{staticClass:"header-anchor",attrs:{href:"#preconditions"}},[a._v("#")]),a._v(" Preconditions")]),a._v(" "),Q("p",[a._v("The driver is assumed to already exist, and be started in the shell using the command syntax:")]),a._v(" "),Q("div",{staticClass:"language-sh extra-class"},[Q("pre",{pre:!0,attrs:{class:"language-sh"}},[Q("code",[Q("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("driver_name"),Q("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" start -d "),Q("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("serial_port"),Q("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),Q("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("-b "),Q("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("baudrate"),Q("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),Q("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" -b p:"),Q("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("param_name"),Q("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),Q("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])])]),Q("p",[a._v("where,")]),a._v(" "),Q("ul",[Q("li",[Q("code",[a._v("-d")]),a._v(": serial port name.")]),a._v(" "),Q("li",[Q("code",[a._v("-b")]),a._v(": Baud rate (optional) if the driver supports multiple baud rates. If supported, the driver must allow you to specify the rate as both a bare baudrate and as a parameter name in the form "),Q("code",[a._v("-b p:<param_name>")]),a._v(" (which can be parsed with "),Q("code",[a._v("px4_get_parameter_value()")]),a._v("). > "),Q("strong",[a._v("Tip")]),a._v(" See the "),Q("a",{attrs:{href:"https://github.com/PX4/Firmware/blob/master/src/drivers/gps/gps.cpp#L1023",target:"_blank",rel:"noopener noreferrer"}},[a._v("gps driver"),Q("OutboundLink")],1),a._v(" for an example.")])]),a._v(" "),Q("h2",{attrs:{id:"making-the-driver-configurable"}},[Q("a",{staticClass:"header-anchor",attrs:{href:"#making-the-driver-configurable"}},[a._v("#")]),a._v(" Making the Driver Configurable")]),a._v(" "),Q("p",[a._v("To make driver configurable:")]),a._v(" "),Q("ol",[Q("li",[Q("p",[a._v("Create a YAML module configuration file:")]),a._v(" "),Q("ul",[Q("li",[a._v("Add a new file in the driver's source directory named "),Q("strong",[a._v("module.yaml")])]),a._v(" "),Q("li",[a._v("Insert the following text and adjust as needed: ``` module_name: uLanding Radar serial_config:"),Q("div",{staticClass:"language- extra-class"},[Q("pre",{pre:!0,attrs:{class:"language-text"}},[Q("code",[a._v("module_name: uLanding Radar\nserial_config:\n    - command: ulanding_radar start -d ${SERIAL_DEV} -b p:${BAUD_PARAM}\n      port_config_param:\n        name: SENS_ULAND_CFG\n        group: Sensors\n")])])])])]),a._v(" "),Q("blockquote",[Q("p",[a._v("command: ulanding_radar start -d "),Q("mjx-container",{staticClass:"MathJax",attrs:{jax:"SVG"}},[Q("svg",{staticStyle:{"vertical-align":"-0.439ex"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"20.131ex",height:"2.059ex",viewBox:"0 -716 8897.7 910"}},[Q("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"matrix(1 0 0 -1 0 0)"}},[Q("g",{attrs:{"data-mml-node":"math"}},[Q("g",{attrs:{"data-mml-node":"TeXAtom"}},[Q("g",{attrs:{"data-mml-node":"mi"}},[Q("path",{attrs:{"data-c":"53",d:"M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"}})]),Q("g",{attrs:{"data-mml-node":"mi",transform:"translate(613, 0)"}},[Q("path",{attrs:{"data-c":"45",d:"M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"}})]),Q("g",{attrs:{"data-mml-node":"mi",transform:"translate(1351, 0)"}},[Q("path",{attrs:{"data-c":"52",d:"M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"}})]),Q("g",{attrs:{"data-mml-node":"mi",transform:"translate(2110, 0)"}},[Q("path",{attrs:{"data-c":"49",d:"M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"}})]),Q("g",{attrs:{"data-mml-node":"mi",transform:"translate(2614, 0)"}},[Q("path",{attrs:{"data-c":"41",d:"M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"}})]),Q("g",{attrs:{"data-mml-node":"msub",transform:"translate(3364, 0)"}},[Q("g",{attrs:{"data-mml-node":"mi"}},[Q("path",{attrs:{"data-c":"4C",d:"M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"}})]),Q("g",{attrs:{"data-mml-node":"mi",transform:"translate(681, -150) scale(0.707)"}},[Q("path",{attrs:{"data-c":"44",d:"M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"}})])]),Q("g",{attrs:{"data-mml-node":"mi",transform:"translate(4680.5, 0)"}},[Q("path",{attrs:{"data-c":"45",d:"M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"}})]),Q("g",{attrs:{"data-mml-node":"mi",transform:"translate(5418.5, 0)"}},[Q("path",{attrs:{"data-c":"56",d:"M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"}})])]),Q("g",{attrs:{"data-mml-node":"mo",transform:"translate(6409.7, 0)"}},[Q("path",{attrs:{"data-c":"2212",d:"M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"}})]),Q("g",{attrs:{"data-mml-node":"mi",transform:"translate(7409.9, 0)"}},[Q("path",{attrs:{"data-c":"62",d:"M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"}})]),Q("g",{attrs:{"data-mml-node":"mi",transform:"translate(7838.9, 0)"}},[Q("path",{attrs:{"data-c":"70",d:"M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"}})]),Q("g",{attrs:{"data-mml-node":"mo",transform:"translate(8619.7, 0)"}},[Q("path",{attrs:{"data-c":"3A",d:"M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"}})])])])])]),a._v("{BAUD_PARAM} port_config_param: name: SENS_ULAND_CFG group: Sensors ``` > "),Q("strong",[a._v("Note")]),a._v(" The full documentation of the module configuration file can be found in the "),Q("a",{attrs:{href:"https://github.com/PX4/Firmware/blob/master/validation/module_schema.yaml",target:"_blank",rel:"noopener noreferrer"}},[a._v("validation/module_schema.yaml"),Q("OutboundLink")],1),a._v(" file. This is also used to validate all configuration files in CI.")],1)])]),a._v(" "),Q("li",[Q("p",[a._v("Add the module configuration to the "),Q("strong",[a._v("CMakeLists.txt")]),a._v(" file for the driver module: px4_add_module( MODULE drivers__ulanding MAIN ulanding_radar SRCS ulanding.cpp MODULE_CONFIG module.yaml )")]),a._v(" "),Q("div",{staticClass:"language- extra-class"},[Q("pre",{pre:!0,attrs:{class:"language-text"}},[Q("code",[a._v("px4_add_module(\n MODULE drivers__ulanding\n MAIN ulanding_radar\n SRCS\n     ulanding.cpp\n MODULE_CONFIG\n     module.yaml\n )\n")])])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);