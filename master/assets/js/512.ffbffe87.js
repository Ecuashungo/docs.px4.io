(window.webpackJsonp=window.webpackJsonp||[]).push([[512],{1838:function(e,t,a){"use strict";a.r(t);var r=a(19),_=Object(r.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"精准着陆"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#精准着陆"}},[e._v("#")]),e._v(" 精准着陆")]),e._v(" "),r("p",[e._v("PX4 支持多旋翼精准着陆（从 PX4 1.7.4版本），这一功能使用 "),r("a",{attrs:{href:"https://irlock.com/products/ir-lock-sensor-precision-landing-kit",target:"_blank",rel:"noopener noreferrer"}},[e._v("IR-LOCK 传感器"),r("OutboundLink")],1),e._v("和 IR 信标（如 "),r("a",{attrs:{href:"https://irlock.com/collections/markone",target:"_blank",rel:"noopener noreferrer"}},[e._v(" IR-LOCK MarkOne "),r("OutboundLink")],1),e._v(" ）以及朝下的距离传感器。 这使飞行器能以约 10 cm 的精度着陆（相比之下，GPS 的精度可能达到几米）。")]),e._v(" "),r("p",[e._v("精准着陆可由切换至 "),r("em",[e._v("精准着陆")]),e._v(" 飞行模式或作为 "),r("a",{attrs:{href:"#mission"}},[e._v("任务")]),e._v(" 的一部分来启动。")]),e._v(" "),r("h2",{attrs:{id:"设置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#设置"}},[e._v("#")]),e._v(" 设置")]),e._v(" "),r("h3",{attrs:{id:"硬件安装"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#硬件安装"}},[e._v("#")]),e._v(" 硬件安装")]),e._v(" "),r("p",[e._v("按照官方指南安装 IR-LOCK 传感器。 确保传感器的 x 轴与飞行器的 y 轴对齐，并且传感器的 y 轴与飞行器的 x 方向对齐（如果摄像头从正面朝下倾斜 90 度，则会出现这种情况）。")]),e._v(" "),r("p",[e._v("安装 "),r("RouterLink",{attrs:{to:"/zh/getting_started/sensor_selection.html#distance"}},[e._v("范围/距离传感器")]),e._v("（已发现 * LidarLite v3 * 效果良好）。")],1),e._v(" "),r("blockquote",[r("p",[r("strong",[e._v("Note")]),e._v("许多基于红外线的距离传感器在 IR-LOCK 信标存在的情况下表现不佳。 有关其他兼容传感器，请参阅 IR-LOCK 指南。")])]),e._v(" "),r("h3",{attrs:{id:"固件配置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#固件配置"}},[e._v("#")]),e._v(" 固件配置")]),e._v(" "),r("p",[e._v("精确着陆需要模块 "),r("code",[e._v("irlock")]),e._v(" 和 "),r("code",[e._v("landing_target_estimator")]),e._v(" ，默认情况下不包含在 PX4 固件中。 They can be included by adding (or uncommenting) the following lines in the relevant configuration file for your flight controller (e.g. "),r("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/master/boards/px4/fmu-v5/default.cmake",target:"_blank",rel:"noopener noreferrer"}},[e._v("PX4-Autopilot/boards/px4/fmu-v5/default.cmake"),r("OutboundLink")],1),e._v("):")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",[r("code",[e._v("drivers/irlock\nmodules/landing_target_estimator\n")])])]),r("p",[e._v("这两个模块也应该在系统启动时启动。 有关说明，请参阅："),r("a",{attrs:{href:"https://dev.px4.io/master/en/concept/system_startup.html#customizing-the-system-startup",target:"_blank",rel:"noopener noreferrer"}},[e._v("自定义系统启动"),r("OutboundLink")],1),e._v("。")]),e._v(" "),r("h2",{attrs:{id:"软件配置-参数"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#软件配置-参数"}},[e._v("#")]),e._v(" 软件配置（参数）")]),e._v(" "),r("p",[e._v("使用"),r("code",[e._v("landing_target_estimator")]),e._v("和"),r("code",[e._v("navigator")]),e._v("参数配置精准着陆，你可以分别在“Landing target estimator”和“Precision land”组中找到这些参数。 最重要的参数将在下面讨论。")]),e._v(" "),r("p",[e._v("参数"),r("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#LTEST_MODE"}},[e._v(" LTEST_MODE ")]),e._v(" 决定信标是被认为静止的还是移动的。 如果 "),r("LT",[e._v(" LTEST_MODE "),e._v("被设置为移动的（例如，它所安装得多旋翼飞行器将要在运动车辆上着陆），则信标测量仅用于在精准着陆控制器中产生位置设定点。 如果"),r("LT",[e._v(" LTEST_MODE "),e._v(" 被设置为静止得，则飞行器位置估计器（EKF2 或 LPE）也使用信标测量结果。")])],1)],1),e._v(" "),r("p",[e._v("参数"),r("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#LTEST_SCALE_X"}},[e._v(" LTEST_SCALE_X ")]),e._v(" 和 "),r("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#LTEST_SCALE_Y"}},[e._v(" LTEST_SCALE_Y ")]),e._v(" 可用于在估计信标相对于飞行器的位置和速度之前对信标测量结果进行缩放。 由于 IR-LOCK 传感器的镜头失真，可能需要进行测量缩放。 注意，在传感器坐标系中考虑"),r("code",[e._v("LTEST_SCALE_X")]),e._v("和"),r("code",[e._v("LTEST_SCALE_Y")]),e._v("，而不是飞行器坐标系。")],1),e._v(" "),r("p",[e._v("要校准这些缩放参数，请将"),r("code",[e._v("LTEST_MODE")]),e._v("设置为移动模式（moving），操作多旋翼飞行器在信标上方飞行，并使飞行器前后和左右运动，同时"),r("a",{attrs:{href:"https://dev.px4.io/master/en/log/logging.html#configuration",target:"_blank",rel:"noopener noreferrer"}},[e._v("记录"),r("OutboundLink")],1),e._v(" "),r("code",[e._v("landing_target_pose")]),e._v("和"),r("code",[e._v("vehicle_local_position")]),e._v("的日志。 然后，将 "),r("code",[e._v("landing_target_pose.vx_rel")]),e._v(" 和 "),r("code",[e._v("landing_target_pose.vy_rel")]),e._v(" 分别与"),r("code",[e._v("vehicle_local_position.vx")]),e._v(" 和 "),r("code",[e._v("vehicle_local_position.vy")]),e._v(" 进行比较（均在NED坐标系中测量）。 如果估计的信标速度始终小于或大于飞行器速度，则调整缩放参数以进行补偿。")]),e._v(" "),r("p",[e._v("如果在 "),r("LT",[e._v(" LTEST_MODE "),e._v(" 设置为静止的情况下进行精准着陆时观察到飞行器缓慢侧向振荡，则信标测量可能会缩放得太高，您应该减小相关方向上的缩放参数。")])],1),e._v(" "),r("h2",{attrs:{id:"精准降落模式"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#精准降落模式"}},[e._v("#")]),e._v(" 精准降落模式")]),e._v(" "),r("p",[e._v("精确着陆可以配置为“必需的”或“随机的”。 模式的选择会影响精准着陆的执行方式。")]),e._v(" "),r("h3",{attrs:{id:"必须的模式"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#必须的模式"}},[e._v("#")]),e._v(" 必须的模式")]),e._v(" "),r("p",[e._v("在 "),r("em",[e._v("必须的模式")]),e._v(" 中，如果在启动着陆时信标不可见，则飞行器将搜索信标。 如果找到信标，飞行器将执行精准着陆。")]),e._v(" "),r("p",[e._v("搜索过程包括爬到搜索高度（"),r("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#PLD_SRCH_ALT"}},[e._v(" PLD_SRCH_ALT ")]),e._v("）。 如果信标在搜索高度仍然不可见并且在搜索超时（"),r("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#PLD_SRCH_TOUT"}},[e._v(" PLD_SRCH_TOUT ")]),e._v("）之后，则在当前位置启动正常着陆。")],1),e._v(" "),r("h3",{attrs:{id:"随机的模式"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#随机的模式"}},[e._v("#")]),e._v(" 随机的模式")]),e._v(" "),r("p",[e._v("在 "),r("em",[e._v("随机的模式")]),e._v(" 中，"),r("em",[e._v("如果")]),e._v("（并且仅当）在启动着陆时信标可见，则飞行器将使用精准着陆<0>。 如果此时不可见，则飞行器立即在当前位置执行正常着陆。")]),e._v(" "),r("h2",{attrs:{id:"执行精准着陆"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#执行精准着陆"}},[e._v("#")]),e._v(" 执行精准着陆")]),e._v(" "),r("blockquote",[r("p",[r("strong",[e._v("Note")]),e._v("由于位置控制器的当前实施方式的限制，只有具有有效的全局位置时才能实现精准着陆。")])]),e._v(" "),r("h3",{attrs:{id:"通过命令"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#通过命令"}},[e._v("#")]),e._v(" 通过命令")]),e._v(" "),r("p",[e._v("精准着陆可以通过命令行接口启动：")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",[r("code",[e._v("commander mode auto:precland\n")])])]),r("p",[e._v("在这种情况下，精准着陆始终被视为“必需的”。")]),e._v(" "),r("p",[r("span",{attrs:{id:"mission"}})]),e._v(" "),r("h3",{attrs:{id:"in-a-mission"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#in-a-mission"}},[e._v("#")]),e._v(" In a Mission")]),e._v(" "),r("p",[e._v("Precision landing can be initiated as part of a "),r("RouterLink",{attrs:{to:"/zh/flying/missions.html"}},[e._v("mission")]),e._v(" using "),r("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#MAV_CMD_NAV_LAND",target:"_blank",rel:"noopener noreferrer"}},[e._v("MAV_CMD_NAV_LAND"),r("OutboundLink")],1),e._v(" with "),r("code",[e._v("param2")]),e._v(" set appropriately:")],1),e._v(" "),r("ul",[r("li",[r("code",[e._v("param2")]),e._v(" = 0: 正常着陆而不使用信标。")]),e._v(" "),r("li",[r("code",[e._v("param2")]),e._v(" = 1："),r("em",[e._v("随机的")]),e._v(" 精准着陆。")]),e._v(" "),r("li",[r("code",[e._v("param2")]),e._v(" = 2："),r("em",[e._v("必需的")]),e._v(" 精准着陆。")])]),e._v(" "),r("h2",{attrs:{id:"仿真"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#仿真"}},[e._v("#")]),e._v(" 仿真")]),e._v(" "),r("p",[e._v("Precision landing with the IR-LOCK sensor and beacon can be simulated in "),r("a",{attrs:{href:"https://dev.px4.io/master/en/simulation/gazebo.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("SITL Gazebo"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("p",[e._v("To start the simulation with the world that contains a IR-LOCK beacon and a vehicle with a range sensor and IR-LOCK camera, run:")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",[r("code",[e._v("make px4_sitl gazebo_iris_irlock\n")])])]),r("p",[e._v("You can change the location of the beacon either by moving it in the Gazebo GUI or by changing its location in the "),r("a",{attrs:{href:"https://github.com/PX4/sitl_gazebo/blob/master/worlds/iris_irlock.world#L42",target:"_blank",rel:"noopener noreferrer"}},[e._v("Gazebo world"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("h2",{attrs:{id:"工作原理"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#工作原理"}},[e._v("#")]),e._v(" 工作原理")]),e._v(" "),r("h3",{attrs:{id:"着陆目标估计器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#着陆目标估计器"}},[e._v("#")]),e._v(" 着陆目标估计器")]),e._v(" "),r("p",[e._v("The "),r("code",[e._v("landing_target_estimator")]),e._v(" takes measurements from the "),r("code",[e._v("irlock")]),e._v(" driver as well as the estimated terrain height to estimate the beacon's position relative to the vehicle.")]),e._v(" "),r("p",[e._v("The measurements in "),r("code",[e._v("irlock_report")]),e._v(' contain the tangent of the angles from the image center to the beacon. In other words, the measurements are the x and y components of the vector pointing towards the beacon, where the z component has length "1". This means that scaling the measurement by the distance from the camera to the beacon results in the vector from the camera to the beacon. This relative position is then rotated into the north-aligned, level body frame using the vehicle\'s attitude estimate. Both x and y components of the relative position measurement are filtered in separate Kalman Filters, which act as simple low-pass filters that also produce a velocity estimate and allow for outlier rejection.')]),e._v(" "),r("p",[e._v("The "),r("code",[e._v("landing_target_estimator")]),e._v(" publishes the estimated relative position and velocity whenever a new "),r("code",[e._v("irlock_report")]),e._v(" is fused into the estimate. Nothing is published if the beacon is not seen or beacon measurements are rejected. The landing target estimate is published in the "),r("code",[e._v("landing_target_pose")]),e._v(" uORB message.")]),e._v(" "),r("h3",{attrs:{id:"改进的飞行器位置估计"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#改进的飞行器位置估计"}},[e._v("#")]),e._v(" 改进的飞行器位置估计")]),e._v(" "),r("p",[e._v("If the beacon is specified to be stationary using the parameter "),r("code",[e._v("LTEST_MODE")]),e._v(", the vehicle's position/velocity estimate can be improved with the help of the beacon measurements. This is done by fusing the beacon's velocity as a measurement of the negative velocity of the vehicle.")]),e._v(" "),r("h3",{attrs:{id:"精准着陆过程"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#精准着陆过程"}},[e._v("#")]),e._v(" 精准着陆过程")]),e._v(" "),r("p",[e._v("The precision land procedure consists of three phases:")]),e._v(" "),r("ol",[r("li",[r("p",[e._v("**水平接近：**飞行器在保持其当前高度的同时水平接近信标。 一旦信标相对于车辆的位置差异低于阈值（"),r("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#PLD_HACC_RAD"}},[e._v(" PLD_HACC_RAD ")]),e._v("），就进入下一阶段。 如果信标在此阶段丢失（不可见超过时长"),r("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#PLD_BTOUT"}},[e._v(" PLD_BTOUT ")]),e._v("），则启动搜索程序（在必须的精准降落模式）或飞行器正常着陆（在随机的精准降落模式）。")],1)]),e._v(" "),r("li",[r("p",[e._v("**信标上方降落：**飞行器下降，同时保持在信标中心上方。 如果信标在此阶段丢失（不可见超过时长"),r("code",[e._v("PLD_BTOUT")]),e._v("），则启动搜索程序（在必须的精准降落模式）或飞行器正常着陆（在随机的精准降落模式）。")])]),e._v(" "),r("li",[r("p",[e._v("**最终接近：**当飞行器接近地面（高度小于"),r("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#PLD_FAPPR_ALT"}},[e._v(" PLD_FAPPR_ALT ")]),e._v("）时，飞行器会下降，同时保持在信标中心上方。 如果信标在此阶段丢失，则会继续下降，与精准着陆的类型无关。")],1)])]),e._v(" "),r("p",[e._v("Search procedures are initiated in 1. and 2. a maximum of "),r("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#PLD_MAX_SRCH"}},[e._v("PLD_MAX_SRCH")]),e._v(" times.")],1),e._v(" "),r("p",[r("img",{attrs:{src:a(435),alt:"Precision Landing Flow Diagram"}})])])}),[],!1,null,null,null);t.default=_.exports},435:function(e,t,a){e.exports=a.p+"assets/img/precland-flow-diagram.88e4e6cb.png"}}]);