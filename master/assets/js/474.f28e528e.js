(window.webpackJsonp=window.webpackJsonp||[]).push([[474],{1208:function(s,t,e){s.exports=e.p+"assets/img/architecture_ros2.f0ce052c.png"},1209:function(s,t,e){s.exports=e.p+"assets/img/architecture_ros.a06cff99.png"},2609:function(s,t,e){"use strict";e.r(t);var a=e(18),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"px4-ros-2-bridge"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#px4-ros-2-bridge"}},[s._v("#")]),s._v(" PX4-ROS 2 Bridge")]),s._v(" "),a("p",[s._v("This section of the guide focusses on the bridge between PX4 and ROS 2, made available through the "),a("RouterLink",{attrs:{to:"/zh/middleware/micrortps.html"}},[s._v("microRTPS Bridge")]),s._v(" and resulting products to interface with ROS 2, "),a("em",[s._v("px4_ros_com")]),s._v(" and "),a("em",[s._v("px4_msgs")]),s._v(" ROS 2 packages.")],1),s._v(" "),a("p",[s._v("It also provides information in how to:")]),s._v(" "),a("ol",[a("li",[s._v("Connect ROS 2 nodes with PX4 (via the "),a("em",[s._v("microRTPS")]),s._v(" Bridge, and using the "),a("code",[s._v("px4_ros_com")]),s._v(" package)")]),s._v(" "),a("li",[s._v('Connect ROS (ROS "version 1") nodes with PX4 by additionally using the '),a("code",[s._v("ros1_bridge")]),s._v(" package to bridge ROS 2 and ROS (1).")])]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[s._v("For information about using the "),a("em",[s._v("PX4-Fast RTPS(DDS) Bridge")]),s._v(" without ROS 2, see the "),a("RouterLink",{attrs:{to:"/zh/middleware/micrortps.html"}},[s._v("RTPS/DDS Interface section")]),s._v(".")],1)]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[s._v("For a more detailed and visual explanation of using the bridge with ROS 2, see the following talks/presentation videos:")]),s._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"https://www.youtube.com/watch?v=2Szw8Pk3Z0Q",target:"_blank",rel:"noopener noreferrer"}},[s._v('PX4 Dev Summit 2019 - "ROS 2 Powered PX4"'),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.youtube.com/watch?v=qhLATrkA_Gw",target:"_blank",rel:"noopener noreferrer"}},[s._v("ROS World 2020 - Getting started with ROS 2 and PX4"),a("OutboundLink")],1)])])]),s._v(" "),a("h2",{attrs:{id:"why-two-bridges-px4-ros2-vs-px4-fastdds"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#why-two-bridges-px4-ros2-vs-px4-fastdds"}},[s._v("#")]),s._v(" Why Two Bridges (PX4/ROS2 vs PX4/FastDDS)?")]),s._v(" "),a("p",[s._v("The "),a("RouterLink",{attrs:{to:"/zh/middleware/micrortps.html"}},[s._v("PX4-Fast RTPS(DDS) Bridge")]),s._v(" and PX4-ROS2 bridge (described here) are conceptually the same.")],1),s._v(" "),a("ul",[a("li",[s._v("They both have a client running on PX4 that communicates with an agent running on a companion computer.")]),s._v(" "),a("li",[s._v("The PX4 firmware build process creates the client code.")]),s._v(" "),a("li",[s._v("The PX4 firmware build process creates IDL files matching a select set of UORB topics that will be shared over DDS.")]),s._v(" "),a("li",[s._v("These IDL files are then used by code generators to create the Agent source code, which can then be compiled for the companion.")])]),s._v(" "),a("p",[s._v('The difference is that ROS 2 uses slightly different DDS types than "raw" RTPS/DDS applications. These types require slighty different agent code, generated from slightly different IDL files. The client-side code is the same in both cases.')]),s._v(" "),a("p",[s._v("The PX4 build process creates ROS2 message files for each uORB message and deploys them to the "),a("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[s._v("px4_msgs"),a("OutboundLink")],1),s._v(" repo (via CI). The "),a("code",[s._v("px4_msgs")]),s._v(" package build uses those "),a("code",[s._v(".msg")]),s._v(" files to generate the ROS 2 interface and type support code to be used by ROS2 nodes. At the same time it generates the IDL files that are consumed by the code generators in "),a("code",[s._v("px4_ros_com")]),s._v(" to generate ROS 2 compatible agent source code.")]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[s._v("This means that you should use a version of "),a("code",[s._v("px4_msgs")]),s._v(" that matches your firmware.")]),s._v(" "),a("p",[s._v("At time of writing there is no easy way to match PX4-Autopilot releases with compatible "),a("code",[s._v("px4_msgs")]),s._v(" (though you could match commit hashes if needed).")]),s._v(" "),a("p",[s._v("In future the development team plan to automatically generate release branches "),a("code",[s._v("px4_msgs")]),s._v(" and "),a("code",[s._v("px4_ros_com")]),s._v(" that are compatible with the respective PX4-Autopilot releases.")])]),s._v(" "),a("h2",{attrs:{id:"code-generation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#code-generation"}},[s._v("#")]),s._v(" Code generation")]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[a("RouterLink",{attrs:{to:"/zh/dev_setup/fast-dds-installation.html"}},[s._v("Fast RTPS(DDS) 2.0.0 and Fast-RTPS-Gen 1.0.4 or later must be installed")]),s._v(" in order to generate the required code!")],1)]),s._v(" "),a("h3",{attrs:{id:"ros-2-ros-application-pipeline"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-ros-application-pipeline"}},[s._v("#")]),s._v(" ROS 2/ROS application pipeline")]),s._v(" "),a("p",[s._v("The application pipeline for ROS 2 is very straightforward! Because ROS 2 uses DDS/RTPS as its native communications middleware, you can create a ROS 2 listener or advertiser node to publish and subscribe to uORB data on PX4, via the "),a("em",[s._v("PX4 Fast RTPS Bridge")]),s._v(". This is shown below.")]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[s._v("You do need to make sure that the message types, headers and source files used on both client and agent side (and consequently, on the ROS nodes) are generated from the same Interface Description Language (IDL) files. The "),a("code",[s._v("px4_ros_com")]),s._v(" package provides the needed infrastructure for generating messages and headers needed by ROS 2.")])]),s._v(" "),a("p",[a("img",{attrs:{src:e(1208),alt:"Architecture with ROS 2"}})]),s._v(" "),a("p",[s._v("The architecture for integrating ROS applications with PX4 is shown below.")]),s._v(" "),a("p",[a("img",{attrs:{src:e(1209),alt:"Architecture with ROS"}})]),s._v(" "),a("p",[s._v("Note the use of "),a("a",{attrs:{href:"https://github.com/ros2/ros1_bridge",target:"_blank",rel:"noopener noreferrer"}},[s._v("ros1_bridge"),a("OutboundLink")],1),s._v(", which bridges messages between ROS 2 and ROS. This is needed because the first version of ROS does not support RTPS.")]),s._v(" "),a("h3",{attrs:{id:"ros-2-ros-applications"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-ros-applications"}},[s._v("#")]),s._v(" ROS 2/ROS applications")]),s._v(" "),a("p",[s._v("The "),a("a",{attrs:{href:"https://github.com/PX4/px4_ros_com",target:"_blank",rel:"noopener noreferrer"}},[s._v("px4_ros_com"),a("OutboundLink")],1),s._v(" package, when built, generates everything needed to access PX4 uORB messages from a ROS 2 node (for ROS (1) you also need "),a("a",{attrs:{href:"https://github.com/ros2/ros1_bridge",target:"_blank",rel:"noopener noreferrer"}},[s._v("ros1_bridge"),a("OutboundLink")],1),s._v("). This includes all the required components of the "),a("em",[s._v("PX4 RTPS bridge")]),s._v(", including the "),a("code",[s._v("micrortps_agent")]),s._v(" and the IDL files (required by the "),a("code",[s._v("micrortps_agent")]),s._v(").")]),s._v(" "),a("p",[s._v("The ROS and ROS 2 message definition headers and interfaces are generated from the "),a("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[s._v("px4_msgs"),a("OutboundLink")],1),s._v(" package, which match the uORB messages counterparts under PX4-Autopilot. These are required by "),a("code",[s._v("px4_ros_com")]),s._v(" when generating the IDL files to be used by the "),a("code",[s._v("micrortps_agent")]),s._v(".")]),s._v(" "),a("p",[s._v("Both "),a("code",[s._v("px4_ros_com")]),s._v(" and "),a("code",[s._v("px4_msgs")]),s._v(" packages have two separate branches:")]),s._v(" "),a("ul",[a("li",[s._v("a "),a("code",[s._v("master")]),s._v(" branch, used with ROS 2. It contains code to generate all the required ROS 2 messages and IDL files to bridge PX4 with ROS 2 nodes.")]),s._v(" "),a("li",[s._v("a "),a("code",[s._v("ros1")]),s._v(" branch, used with ROS. It contains code to generate the ROS message headers and source files, which can be used "),a("em",[s._v("with")]),s._v(" the "),a("code",[s._v("ros1_bridge")]),s._v(" to share data between PX4 and ROS.")])]),s._v(" "),a("p",[s._v("Both branches in "),a("code",[s._v("px4_ros_com")]),s._v(" additionally include some example listener and advertiser example nodes.")]),s._v(" "),a("h2",{attrs:{id:"agent-interfacing-with-a-ros-2-middleware"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#agent-interfacing-with-a-ros-2-middleware"}},[s._v("#")]),s._v(" Agent interfacing with a ROS 2 middleware")]),s._v(" "),a("p",[s._v("Building "),a("code",[s._v("px4_ros_com")]),s._v(" automatically generates and builds the agent application, though it requires (as a dependency), that the "),a("code",[s._v("px4_msgs")]),s._v(" package also gets build on the same ROS 2 workspace (or overlaid from another ROS 2 workspace). Since it is also installed using the "),a("a",{attrs:{href:"http://design.ros2.org/articles/build_tool.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("colcon")]),a("OutboundLink")],1),s._v(" build tools, running it works exactly the same way as the above. Check the "),a("strong",[s._v("Building the "),a("code",[s._v("px4_ros_com")]),s._v(" package")]),s._v(" for details about the build structure.")]),s._v(" "),a("h2",{attrs:{id:"supported-uorb-messages"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#supported-uorb-messages"}},[s._v("#")]),s._v(" Supported uORB messages")]),s._v(" "),a("p",[s._v("The generated bridge code will enable a specified subset of uORB topics to be published/subscribed via RTPS. This is true for both ROS or non-ROS applications.")]),s._v(" "),a("p",[s._v("For "),a("em",[s._v("automatic code generation")]),s._v(" there's a "),a("em",[s._v("yaml")]),s._v(" definition file in the PX4 "),a("strong",[s._v("PX4-Autopilot/msg/tools/")]),s._v(" directory called "),a("strong",[s._v("uorb_rtps_message_ids.yaml")]),s._v(". This file defines the set of uORB messages to be used with RTPS, whether the messages are to be sent, received or both, and the RTPS ID for the message to be used in ROS 2 middleware.")]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[s._v("An RTPS ID must be set for all messages.")])]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[s._v("An API change in ROS 2 Dashing means that we now use the "),a("code",[s._v("rosidl_generate_interfaces()")]),s._v(" CMake module (in "),a("code",[s._v("px4_msgs")]),s._v(") to generate the IDL files that we require for microRTPS agent generation (in "),a("code",[s._v("px4_ros_com")]),s._v("). PX4-Autopilot includes a template for the IDL file generation, which is only used during the PX4 build process.")]),s._v(" "),a("p",[s._v("The "),a("code",[s._v("px4_msgs")]),s._v(" build generates "),a("em",[s._v("slightly different")]),s._v(" IDL files for use with ROS 2/ROS (than are built for PX4 firmware). The "),a("strong",[s._v("uorb_rtps_message_ids.yaml")]),s._v(" is transformed in a way that the message names become "),a("em",[s._v("PascalCased")]),s._v(" (the name change is irrelevant to the client-agent communication, but is critical for ROS 2, since the message naming must follow the PascalCase convention). The new IDL files also reverse the messages that are sent and received (required because if a message is sent from the client side, then it's received on the agent side, and vice-versa).")])]),s._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("rtps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ActuatorArmed\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ActuatorControl\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Airspeed\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" BatteryStatus\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" CameraCapture\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" CameraTrigger\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("receive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" SensorBaro\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("receive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n")])])]),a("h2",{attrs:{id:"building-the-px4-ros-com-and-px4-msgs-packages"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#building-the-px4-ros-com-and-px4-msgs-packages"}},[s._v("#")]),s._v(" Building the "),a("code",[s._v("px4_ros_com")]),s._v(" and "),a("code",[s._v("px4_msgs")]),s._v(" packages")]),s._v(" "),a("p",[s._v("Install and setup both ROS 2 and ROS environments on your development machine and separately clone the "),a("code",[s._v("px4_ros_com")]),s._v(" and "),a("code",[s._v("px4_msgs")]),s._v(" repo for both the "),a("code",[s._v("master")]),s._v(" and "),a("code",[s._v("ros1")]),s._v(" branches (see "),a("a",{attrs:{href:"#px4_ros_com"}},[s._v("above for more information")]),s._v(").")]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[s._v("Only the master branch is needed for ROS 2 (both are needed to target ROS).")])]),s._v(" "),a("h3",{attrs:{id:"installing-ros-2-and-respective-dependencies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installing-ros-2-and-respective-dependencies"}},[s._v("#")]),s._v(" Installing ROS 2 and Respective Dependencies")]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[s._v("This install and build guide covers ROS 2 Foxy in Ubuntu 20.04.")])]),s._v(" "),a("ol",[a("li",[a("p",[a("a",{attrs:{href:"https://index.ros.org/doc/ros2/Installation/Foxy/Linux-Install-Debians/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Install ROS 2 Foxy"),a("OutboundLink")],1)])]),s._v(" "),a("li",[a("p",[s._v("The install process should also install the "),a("em",[s._v("colcon")]),s._v(" build tools, but in case that doesn't happen, you can install the tools manually:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" python3-colcon-common-extensions\n")])])])]),s._v(" "),a("li",[a("p",[a("em",[s._v("eigen3_cmake_module")]),s._v(" is also required, since Eigen3 is used on the transforms library:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ros-dashing-eigen3-cmake-module\n")])])])]),s._v(" "),a("li",[a("p",[s._v("Some Python dependencies must also be installed (using "),a("em",[s._v("pip")]),s._v(" or "),a("em",[s._v("apt")]),s._v("):")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" pip3 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -U empy pyros-genmsg setuptools\n")])])])])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[s._v("If you want to use ROS 1 topics, in communication with ROS 2, you need to build the "),a("code",[s._v("ros1_bridge")]),s._v(" from source, and setup a separate workspace. Check the section: "),a("strong",[s._v("Setting up the workspaces > ROS 1 workspace")]),s._v(".")])]),s._v(" "),a("h3",{attrs:{id:"setting-up-the-workspaces"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-the-workspaces"}},[s._v("#")]),s._v(" Setting up the workspaces")]),s._v(" "),a("p",[s._v("Since the ROS 2 and ROS require different environments you will need a separate workspace for each ROS version. As an example:")]),s._v(" "),a("h4",{attrs:{id:"ros-2-workspace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-workspace"}},[s._v("#")]),s._v(" ROS 2 workspace")]),s._v(" "),a("p",[s._v("For ROS 2, create a workspace using:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p ~/px4_ros_com_ros2/src\n")])])]),a("p",[s._v("Then, clone the respective ROS 2 ("),a("code",[s._v("master")]),s._v(") branch to the "),a("code",[s._v("/src")]),s._v(" directory:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/PX4/px4_ros_com.git ~/px4_ros_com_ros2/src/px4_ros_com "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# clones the master branch")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/PX4/px4_msgs.git ~/px4_ros_com_ros2/src/px4_msgs\n")])])]),a("h4",{attrs:{id:"ros-1-workspace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros-1-workspace"}},[s._v("#")]),s._v(" ROS (1) workspace")]),s._v(" "),a("p",[s._v("For ROS, follow exactly the same process, but create a different directory and clone a different branch:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p ~/px4_ros_com_ros1/src\n")])])]),a("p",[s._v("Then, clone the respective ROS 2 ("),a("code",[s._v("ros1")]),s._v(") branch to the "),a("code",[s._v("/src")]),s._v(" directory:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/PX4/px4_ros_com.git ~/px4_ros_com_ros1/src/px4_ros_com -b ros1 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# clones the 'ros1' branch")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/PX4/px4_msgs.git ~/px4_ros_com_ros1/src/px4_msgs -b ros1\n")])])]),a("h3",{attrs:{id:"building-the-workspaces"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#building-the-workspaces"}},[s._v("#")]),s._v(" Building the workspaces")]),s._v(" "),a("p",[s._v("The directory "),a("code",[s._v("px4_ros_com/scripts")]),s._v(" contains multiple scripts that can be used to build both workspaces.")]),s._v(" "),a("p",[s._v("To build both (ROS (1) and ROS 2) workspaces with a single script, use the "),a("code",[s._v("build_all.bash")]),s._v(". Check the usage with "),a("code",[s._v("source build_all.bash --help")]),s._v(". The most common way of using it is by passing the ROS(1) workspace directory path and also the PX4-Autopilot directory path:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" build_all.bash --ros1_ws_dir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("path/to/px4_ros_com_ros1/ws"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[s._v("Using the "),a("code",[s._v("--verbose")]),s._v(" argument will allow you to see the full "),a("em",[s._v("colcon")]),s._v(" build output.")])]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[s._v("The build process will open new tabs on the console, corresponding to different stages of the build process that need to have different environment configurations sourced.")])]),s._v(" "),a("p",[s._v("One can also use the following individual scripts in order to build the individual parts:")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("build_ros1_bridge.bash")]),s._v(", to build the "),a("code",[s._v("ros1_bridge")]),s._v(";")]),s._v(" "),a("li",[a("code",[s._v("build_ros1_workspace.bash")]),s._v(" (only on the "),a("code",[s._v("ros1")]),s._v(" branch of "),a("code",[s._v("px4_ros_com")]),s._v("), to build the ROS1 workspace to where the "),a("code",[s._v("px4_ros_com")]),s._v(" and "),a("code",[s._v("px4_msgs")]),s._v(" "),a("code",[s._v("ros1")]),s._v(" branches were cloned;")]),s._v(" "),a("li",[a("code",[s._v("build_ros2_workspace.bash")]),s._v(", to build the ROS 2 workspace to where the "),a("code",[s._v("px4_ros_com")]),s._v(" and "),a("code",[s._v("px4_msgs")]),s._v(" "),a("code",[s._v("master")]),s._v(" branches were cloned.")])]),s._v(" "),a("p",[s._v("The steps below show how to "),a("em",[s._v("manually")]),s._v(" build the packages (provided for your information/better understanding only).")]),s._v(" "),a("p",[s._v("To build the ROS 2 workspace only:")]),s._v(" "),a("ol",[a("li",[a("p",[a("code",[s._v("cd")]),s._v(" into "),a("code",[s._v("px4_ros_com_ros2")]),s._v(" dir and source the ROS 2 environment. Don't mind if it tells you that a previous workspace was set before:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/px4_ros_com_ros2\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /opt/ros/foxy/setup.bash\n")])])])]),s._v(" "),a("li",[a("p",[s._v("Build the workspace:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("colcon build --symlink-install --event-handlers console_direct+\n")])])])])]),s._v(" "),a("p",[s._v("To build both workspaces (in replacement of the previous steps):")]),s._v(" "),a("ol",[a("li",[a("p",[a("code",[s._v("cd")]),s._v(" into "),a("code",[s._v("px4_ros_com_ros2")]),s._v(" dir and source the ROS 2 environment. Don't mind if it tells you that a previous workspace was set before:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /opt/ros/foxy/setup.bash\n")])])])]),s._v(" "),a("li",[a("p",[s._v("Clone the "),a("code",[s._v("ros1_bridge")]),s._v(" package so it can be built on the ROS 2 workspace:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/ros2/ros1_bridge.git -b dashing ~/px4_ros_com_ros2/src/ros1_bridge\n")])])])]),s._v(" "),a("li",[a("p",[s._v("Build the "),a("code",[s._v("px4_ros_com")]),s._v(" and "),a("code",[s._v("px4_msgs")]),s._v(" packages, excluding the "),a("code",[s._v("ros1_bridge")]),s._v(" package:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("colcon build --symlink-install --packages-skip ros1_bridge --event-handlers console_direct+\n")])])])])]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[a("code",[s._v("--event-handlers console_direct+")]),s._v(" only serves the purpose of adding verbosity to the "),a("code",[s._v("colcon")]),s._v(' build process and can be removed if one wants a more "quiet" build.')])]),s._v(" "),a("ol",[a("li",[a("p",[s._v("Then, follows the process of building the ROS(1) packages side. For that, one requires to open a new terminal window and source the ROS(1) environment that has installed on the system:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /opt/ros/melodic/setup.bash\n")])])])]),s._v(" "),a("li",[a("p",[s._v("On the terminal of the previous step, build the "),a("code",[s._v("px4_ros_com")]),s._v(" and "),a("code",[s._v("px4_msgs")]),s._v(" packages on the ROS end:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/px4_ros_com_ros1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" colcon build --symlink-install --event-handlers console_direct+\n")])])])]),s._v(" "),a("li",[a("p",[s._v("Before building the "),a("code",[s._v("ros1_bridge")]),s._v(", one needs to open a new terminal and then source the environments and workspaces following the order below:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/px4_ros_com_ros1/install/setup.bash\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/px4_ros_com_ros2/install/setup.bash\n")])])])]),s._v(" "),a("li",[a("p",[s._v("Finally, build the "),a("code",[s._v("ros1_bridge")]),s._v(". Note that the build process may consume a lot of memory resources. On a resource limited machine, reduce the number of jobs being processed in parallel (e.g. set environment variable "),a("code",[s._v("MAKEFLAGS=-j1")]),s._v("). For more details on the build process, see the build instructions on the "),a("a",{attrs:{href:"https://github.com/ros2/ros1_bridge",target:"_blank",rel:"noopener noreferrer"}},[s._v("ros1_bridge"),a("OutboundLink")],1),s._v(" package page.")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/px4_ros_com_ros2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" colcon build --symlink-install --packages-select ros1_bridge --cmake-force-configure --event-handlers console_direct+\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"cleaning-the-workspaces"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cleaning-the-workspaces"}},[s._v("#")]),s._v(" Cleaning the workspaces")]),s._v(" "),a("p",[s._v("After building the workspaces there are many files that must be deleted before you can do a clean/fresh build (for example, after you have changed some code and want to rebuild). Unfortunately "),a("em",[s._v("colcon")]),s._v(" does not currently have a way of cleaning the generated "),a("strong",[s._v("build")]),s._v(", "),a("strong",[s._v("install")]),s._v(" and "),a("strong",[s._v("log")]),s._v(" directories, so these directories must be deleted manually.")]),s._v(" "),a("p",[s._v("The "),a("strong",[s._v("clean_all.bash")]),s._v(" script (in "),a("strong",[s._v("px4_ros_com/scripts")]),s._v(") is provided to ease this cleaning process. The most common way of using it is by passing it the ROS(1) workspace directory path (since it's usually not on the default path):")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" clean_all.bash --ros1_ws_dir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("path/to/px4_ros_com_ros1/ws"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("h2",{attrs:{id:"creating-a-ros-2-listener"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creating-a-ros-2-listener"}},[s._v("#")]),s._v(" Creating a ROS 2 listener")]),s._v(" "),a("p",[s._v("With the "),a("code",[s._v("px4_ros_com")]),s._v(" built successfully, one can now take advantage of the generated "),a("em",[s._v("microRTPS")]),s._v(" agent app and also from the generated sources and headers of the ROS 2 msgs from "),a("code",[s._v("px4_msgs")]),s._v(", which represent a one-to-one matching with the uORB counterparts.")]),s._v(" "),a("p",[s._v("To create a listener node on ROS 2, lets take as an example the "),a("code",[s._v("sensor_combined_listener.cpp")]),s._v(" node under "),a("code",[s._v("px4_ros_com/src/examples/listeners")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("<rclcpp/rclcpp.hpp>")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("<px4_msgs/msg/sensor_combined.hpp>")])]),s._v("\n")])])]),a("p",[s._v("The above brings to use the required C++ libraries to interface with the ROS 2 middleware. It also includes the required message header file.")]),s._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @brief Sensor Combined uORB topic data callback\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SensorCombinedListener")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token base-clause"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" rclcpp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n")])])]),a("p",[s._v("The above creates a "),a("code",[s._v("SensorCombinedListener")]),s._v(" class that subclasses the generic "),a("code",[s._v("rclcpp::Node")]),s._v(" base class.")]),s._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("explicit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("SensorCombinedListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sensor_combined_listener"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        subscription_ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("create_subscription"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("px4_msgs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("SensorCombined"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SensorCombined_PubSubTopic"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" px4_msgs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("SensorCombined"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("UniquePtr msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RECEIVED SENSOR COMBINED DATA"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"============================="')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts: "')]),s._v("          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("timestamp    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gyro_rad[0]: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("gyro_rad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gyro_rad[1]: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("gyro_rad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gyro_rad[2]: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("gyro_rad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gyro_integral_dt: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("gyro_integral_dt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"accelerometer_timestamp_relative: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("accelerometer_timestamp_relative "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"accelerometer_m_s2[0]: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("accelerometer_m_s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"accelerometer_m_s2[1]: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("accelerometer_m_s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"accelerometer_m_s2[2]: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("accelerometer_m_s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"accelerometer_integral_dt: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("accelerometer_integral_dt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("This creates a callback function for when the "),a("code",[s._v("sensor_combined")]),s._v(" uORB messages are received (now as RTPS/DDS messages). It outputs the content of the message fields each time the message is received.")]),s._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    rclcpp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("Subscription"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("px4_msgs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("SensorCombined"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("SharedPtr subscription_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("The above create a subscription to the "),a("code",[s._v("sensor_combined_topic")]),s._v(" which can be matched with one or more compatible ROS publishers.")]),s._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" argc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Starting sensor_combined listener node..."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setvbuf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("stdout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _IONBF"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" BUFSIZ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    rclcpp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("argc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    rclcpp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("spin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("make_shared"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("SensorCombinedListener"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    rclcpp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("The instantiation of the "),a("code",[s._v("SensorCombinedListener")]),s._v(" class as a ROS node is done on the "),a("code",[s._v("main")]),s._v(" function.")]),s._v(" "),a("h2",{attrs:{id:"creating-a-ros-2-advertiser"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creating-a-ros-2-advertiser"}},[s._v("#")]),s._v(" Creating a ROS 2 advertiser")]),s._v(" "),a("p",[s._v("A ROS 2 advertiser node publishes data into the DDS/RTPS network (and hence to PX4).")]),s._v(" "),a("p",[s._v("Taking as an example the "),a("code",[s._v("debug_vect_advertiser.cpp")]),s._v(" under "),a("code",[s._v("px4_ros_com/src/advertisers")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("<chrono>")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("<rclcpp/rclcpp.hpp>")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("<px4_msgs/msg/debug_vect.hpp>")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("using")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("namespace")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("chrono_literals"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("Bring in the required headers, including the "),a("code",[s._v("debug_vect")]),s._v(" msg header.")]),s._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DebugVectAdvertiser")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token base-clause"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" rclcpp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n")])])]),a("p",[s._v("The above creates a "),a("code",[s._v("DebugVectAdvertiser")]),s._v(" class that subclasses the generic "),a("code",[s._v("rclcpp::Node")]),s._v(" base class.")]),s._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("DebugVectAdvertiser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"debug_vect_advertiser"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        publisher_ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("create_publisher"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("px4_msgs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("DebugVect"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DebugVect_PubSubTopic"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("auto")]),s._v(" timer_callback "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("auto")]),s._v(" debug_vect "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" px4_msgs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("DebugVect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("timestamp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("chrono"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("time_point_cast"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("chrono"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("microseconds"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("chrono"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("steady_clock"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("time_since_epoch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("string name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("copy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("begin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("begin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("y "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("z "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("RCLCPP_INFO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_logger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\033[97m Publishing debug_vect: time: %llu x: %f y: %f z: %f \\033[0m"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("z"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("publisher_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("publish")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        timer_ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("create_wall_timer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v("ms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" timer_callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    rclcpp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("TimerBase"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("SharedPtr timer_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    rclcpp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("Publisher"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("px4_msgs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("DebugVect"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("SharedPtr publisher_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("This creates a function for when messages are to be sent. The messages are sent based on a timed callback, which sends two messages per second based on a timer.")]),s._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" argc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Starting debug_vect advertiser node..."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setvbuf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("stdout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _IONBF"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" BUFSIZ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    rclcpp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("argc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    rclcpp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("spin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("make_shared"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("DebugVectAdvertiser"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    rclcpp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("The instantiation of the "),a("code",[s._v("DebugVectAdvertiser")]),s._v(" class as a ROS node is done on the "),a("code",[s._v("main")]),s._v(" function.")]),s._v(" "),a("h2",{attrs:{id:"creating-a-ros-1-listener"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creating-a-ros-1-listener"}},[s._v("#")]),s._v(" Creating a ROS(1) listener")]),s._v(" "),a("p",[s._v("The creation of ROS nodes is a well known and documented process. An example of a ROS listener for "),a("code",[s._v("sensor_combined")]),s._v(" messages can be found in the "),a("code",[s._v("ros1")]),s._v(" branch repo, under "),a("code",[s._v("px4_ros_com/src/listeners")]),s._v(".")]),s._v(" "),a("h2",{attrs:{id:"offboard-control"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#offboard-control"}},[s._v("#")]),s._v(" Offboard control")]),s._v(" "),a("p",[s._v("Please check the "),a("RouterLink",{attrs:{to:"/zh/ros/ros2_offboard_control.html"}},[s._v("ROS 2 Offboard control example")]),s._v(" section.")],1),s._v(" "),a("h2",{attrs:{id:"quick-start-testing-the-bridge-with-px4-sitl"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#quick-start-testing-the-bridge-with-px4-sitl"}},[s._v("#")]),s._v(" Quick-start testing the bridge with PX4 SITL")]),s._v(" "),a("p",[s._v("To quickly test the package (using PX4 SITL with Gazebo):")]),s._v(" "),a("ol",[a("li",[s._v("Start PX4 SITL with Gazebo using:"),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" px4_sitl_rtps gazebo\n")])])])])]),s._v(" "),a("p",[s._v("To only use ROS 2:")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("Make sure to source the workspace configuration first:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/px4_ros_com_ros2/install/setup.bash\n")])])])]),s._v(" "),a("li",[a("p",[s._v("On a terminal, source the ROS 2 workspace and then start the "),a("code",[s._v("micrortps_agent")]),s._v(" daemon with UDP as the transport protocol:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/px4_ros_com_ros2/install/setup.bash\n$ micrortps_agent -t UDP\n")])])])]),s._v(" "),a("li",[a("p",[s._v("On the "),a("RouterLink",{attrs:{to:"/zh/debug/system_console.html"}},[s._v("NuttShell/System Console")]),s._v(" of the SITL window, start the "),a("code",[s._v("micrortps_client")]),s._v(" daemon also in UDP:")],1),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("pxh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" micrortps_client start -t UDP\n")])])])])]),s._v(" "),a("p",[s._v("To use ROS (1) and ROS 2:")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("On one terminal, source the ROS 2 environment and workspace and launch the "),a("code",[s._v("ros1_bridge")]),s._v(" (this allows ROS 2 and ROS nodes to communicate with each other). Also set the "),a("code",[s._v("ROS_MASTER_URI")]),s._v(" where the "),a("code",[s._v("roscore")]),s._v(" is/will be running:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /opt/ros/dashing/setup.bash\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/px4_ros_com_ros2/install/local_setup.bash\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ROS_MASTER_URI")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://localhost:11311\n$ ros2 run ros1_bridge dynamic_bridge\n")])])])]),s._v(" "),a("li",[a("p",[s._v("On another terminal, source the ROS workspace and launch the "),a("code",[s._v("sensor_combined")]),s._v(" listener node. Since you are launching through "),a("code",[s._v("roslaunch")]),s._v(", this will also automatically start the "),a("code",[s._v("roscore")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/px4_ros_com_ros1/install/setup.bash\n$ roslaunch px4_ros_com sensor_combined_listener.launch\n")])])])]),s._v(" "),a("li",[a("p",[s._v("On a terminal, source the ROS 2 workspace and then start the "),a("code",[s._v("micrortps_agent")]),s._v(" daemon with UDP as the transport protocol:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/px4_ros_com_ros2/install/setup.bash\n$ micrortps_agent -t UDP\n")])])])]),s._v(" "),a("li",[a("p",[s._v("On the "),a("RouterLink",{attrs:{to:"/zh/debug/system_console.html"}},[s._v("NuttShell/System Console")]),s._v(", start the "),a("code",[s._v("micrortps_client")]),s._v(" daemon also in UDP:")],1),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" micrortps_client start -t UDP\n")])])])])]),s._v(" "),a("p",[s._v("For both cases above, in case of success. you will be able to see the data being printed on the terminal/console where you launched the ROS listener:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("RECEIVED DATA FROM SENSOR COMBINED\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\nts: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("870938190")]),s._v("\ngyro_rad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00341645")]),s._v("\ngyro_rad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00626475")]),s._v("\ngyro_rad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": -0.000515705\ngyro_integral_dt: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4739")]),s._v("\naccelerometer_timestamp_relative: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\naccelerometer_m_s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": -0.273381\naccelerometer_m_s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0949186")]),s._v("\naccelerometer_m_s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": -9.76044\naccelerometer_integral_dt: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4739")]),s._v("\n")])])]),a("p",[s._v("You can also verify the rate of the message using "),a("code",[s._v("rostopic hz")]),s._v(". For the case of "),a("code",[s._v("sensor_combined")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("average rate: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("248.187")]),s._v("\n min: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".000s max: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".012s std dev: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".00147s window: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2724")]),s._v("\naverage rate: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("248.006")]),s._v("\n min: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".000s max: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".012s std dev: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".00147s window: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2972")]),s._v("\naverage rate: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("247.330")]),s._v("\n min: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".000s max: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".012s std dev: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".00148s window: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3212")]),s._v("\naverage rate: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("247.497")]),s._v("\n min: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".000s max: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".012s std dev: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".00149s window: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3464")]),s._v("\naverage rate: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("247.458")]),s._v("\n min: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".000s max: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".012s std dev: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".00149s window: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3712")]),s._v("\naverage rate: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("247.485")]),s._v("\n min: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".000s max: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".012s std dev: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".00148s window: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3960")]),s._v("\n")])])]),a("ol",[a("li",[s._v("You can also test the "),a("code",[s._v("sensor_combined")]),s._v(" ROS 2 listener by launching the example launch file in the terminal:"),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/px4_ros_com_ros2/install/setup.bash\n$ ros2 launch px4_ros_com sensor_combined_listener.launch.py\n")])])])])]),s._v(" "),a("p",[s._v("And it should also get data being printed to the console output.")]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("注解")]),s._v(" "),a("p",[s._v("If ones uses the "),a("code",[s._v("build_all.bash")]),s._v(" script, it automatically opens and sources all the required terminals, so you just have to run the respective apps in each terminal.")])]),s._v(" "),a("h2",{attrs:{id:"additional-information"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#additional-information"}},[s._v("#")]),s._v(" Additional information")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/ros2/ros2/wiki/DDS-and-ROS-middleware-implementations",target:"_blank",rel:"noopener noreferrer"}},[s._v("DDS and ROS middleware implementations"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);